; DECODIFICADOR DE NÚMERO DE 2 BITS A DIS´LAY DE 7 SEGMENTOS DE CÁTODO COMÚN

#include "p18f4550.inc"

;PORTD -GFAB ECD
#DEFINE CERO B'1011011' ; M
#DEFINE UNO  B'1011111' ; a
#DEFINE DOS  B'1000100' ;r
#DEFINE TRES B'0000010' ;i
#DEFINE CUATRO B'1011111' ;a
#DEFINE CINCO B'1000110' ;n
#DEFINE SEIS B'1011111' ;a
#DEFINE SIETE B'0000000' ; espacio
#DEFINE OCHO B'1101011' ; y
#DEFINE NUEVE B'0000000' ; espacio
#DEFINE DIEZ B'1011011' ; M
#DEFINE ONCE B'0000010' ; i
#DEFINE DOCE B'1110111' ; g
#DEFINE TRECE B'0101111' ; u
#DEFINE CATORCE B'1110101' ; e
#DEFINE QUINCE B'0100100' ; l

#DEFINE COPIA B'00000000' 

ORG .0
GOTO INICIO
TABLA ; TODO ESTO ES POSIBLE POR EL PC
  AADWF, PCL,F,0 ; PC 40
  DT CERO,UNO,DOS,TRES,CUATRO,CINCO,SEIS,SIETE,OCHO,NUEVE,DIEZ,ONCE,DOCE,TRECE,CATORCE,QUINCE
  ;RETLW CERO ; PC 42
  ;RETLW UNO ; PC 44
  ;RETLW DOS ; PC 46
  ;RETLW TRES ; PC 48
  ;RETLW CUATRO ;PC 50
  ;RETLW CINCO ; PC 52
  ;RETLW SEIS ; PC 54
  ;RETLW SIETE ; PC 56
  ;RETLW OCHO ; PC 58
  ;RETLW NUEVE ; PC 60

INICIO
  MOVLW B'00000011' ;PC 2
  MOVWF TRISA,0 ; PC 4
  CLRF PROTA,0 ; PC 6
  MOVLW .7 ; PC 8
  MOVWF CMCON,0 ; PC 10
  MOVLW .15 ; PC 12
  MOVWF ADCON1,0 ; PC 14
  CLRF TRISD,0 ; PC 16
  CLRF PORTD,0 ; PC18

MAIN
  MOVFF PORTA,COPIA ; PC 20
  MOVLW B'00001111' ; PC=22 MÁSCARA
  ANDWF COPIA,W,1 ; PC=24 W TIENE LA ENTRADA ENMASCARADA Y ES EL DATO QUE SE BUSCARÁ EN LA TABLA
                  ; PARA ESTE PROGRAMA ES EL DATO A DECODIFICAR
  MULLW .2 ; PC= 26
  MOVF PRODL,W,0 ; PC = 28 AQUÍ W YA ES PAR
  CALL TABLA ; PC = 30 TV ES UNA SUBRUTINA, AQUÍ SE LLAMA
  MOVWF PORTD,0 ; PC = 34 W TRAE LA DECODIFICACION
  GOTO MAIN ; PC = 36
  END